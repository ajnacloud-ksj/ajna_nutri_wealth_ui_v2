name: Deploy UI to CloudFront

on:
  push:
    branches: [main]
  workflow_dispatch:  # Allow manual deployment

permissions:
  id-token: write
  contents: read

jobs:
  deploy:
    uses: ajnacloud-ksj/ajna-github-workflows/.github/workflows/reusable-static-site.yml@27be22d
    with:
      # AWS Configuration
      aws-region: 'ap-south-1'
      
      # S3 bucket for hosting static files
      s3-bucket: 'ajnacloud-static-websites'
      
      # Optional: S3 path prefix (leave empty for root)
      s3-path: 'ajna_nutri_wealth_ui_v2'
      

      
      # Working directory (where package.json is located)
      working-directory: '.'
      
      # Node.js version for building
      node-version: '20'
      
      # Backend API URL (injected as VITE_API_URL during build)
      # Backend API URL (hardcoded per user request)
      api-url: 'https://msitjd6d5voovsgvxlxvkcbe3u0viaiw.lambda-url.ap-south-1.on.aws/'

      # Auth mode: 'local' or 'cognito'
      auth-mode: 'cognito'

      # Cognito configuration (injected during build for better performance)
      user-pool-id: 'ap-south-1_DxH2t3WLy'
      user-pool-client-id: '1tn7u6t6mr5qr1quudqn89mpfd'
      cognito-region: 'ap-south-1'
    secrets:
      AWS_ROLE_ARN: ${{ secrets.AWS_ROLE_ARN }}
      CLOUDFRONT_DISTRIBUTION_ID: 'E3KAGPTHZ7N8J0'
